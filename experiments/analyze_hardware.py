#!/usr/bin/env python3
"""Analyze all Tuna-9 hardware results: GHZ, QAOA MaxCut, Quantum Walk.

Job IDs:
  429972: GHZ Z-basis
  429973: GHZ X-basis
  429974: QAOA MaxCut (γ=π/2, β=π/4)
  429975: Walk depth=1
  429976: Walk depth=2
  429977: Walk depth=3
"""

import json
import math

# ── Tuna-9 topology ──────────────────────────────────────────────────────────

EDGES = [
    (0, 1), (0, 2), (1, 3), (1, 4), (2, 4), (2, 5),
    (3, 6), (4, 6), (4, 7), (5, 7), (6, 8), (7, 8),
]
N_QUBITS = 9
PARTITION_A = {0, 3, 4, 5, 8}
PARTITION_B = {1, 2, 6, 7}
MAX_CUT = 12

# Optimal MaxCut bitstrings (QI convention: rightmost = q[0])
# A={0,3,4,5,8} → bits 0,3,4,5,8 = 1 → binary 100111001 → "100111001"
# B={1,2,6,7} → bits 1,2,6,7 = 1 → binary 011000110 → "011000110"
OPTIMAL_BITSTRINGS = {"100111001", "011000110"}


# ── Hardware results ──────────────────────────────────────────────────────────

GHZ_Z = {"000000000": 1472, "111111111": 926, "111110111": 314, "000001000": 292, "111111110": 131, "000000010": 92, "111111101": 74, "000000100": 58, "111110110": 56, "000001010": 46, "111111100": 43, "000001100": 40, "111110101": 38, "000000110": 36, "000010000": 35, "111101111": 30, "000000001": 26, "111100111": 26, "111110100": 24, "000001110": 17, "000011000": 15, "000000011": 14, "111011111": 14, "000010010": 13, "111101110": 12, "000010100": 12, "111101101": 11, "000100000": 11, "111100110": 10, "111110010": 9, "000100010": 9, "111110011": 8, "000001001": 8, "000010001": 7, "111100101": 7, "111011110": 7, "111111000": 6, "000000111": 6, "000011010": 6, "111101100": 5, "000010110": 5, "000001011": 5, "111010111": 5, "111110000": 4, "000100100": 4, "111100100": 3, "111011101": 3, "001000000": 3, "000011100": 3, "000100001": 3, "111010110": 3, "000110000": 3, "000010011": 2, "111100011": 2, "111001111": 2, "111011100": 2, "000001111": 2, "000100110": 2, "000011001": 2, "110111111": 2, "000010101": 1, "101111111": 1, "111000111": 1, "111100010": 1, "000110010": 1, "011111111": 1, "001001000": 1, "000110100": 1, "000011110": 1, "111010101": 1, "001000010": 1, "000100011": 1, "000011011": 1, "111011010": 1}

GHZ_X = {"000000000": 23, "000000001": 2, "000000010": 7, "000000011": 12, "000000100": 8, "000000101": 12, "000000110": 11, "000000111": 4, "000001000": 4, "000001001": 10, "000001010": 10, "000001011": 3, "000001100": 16, "000001101": 2, "000001110": 11, "000001111": 14, "000010000": 6, "000010001": 14, "000010010": 14, "000010011": 2, "000010100": 13, "000010101": 3, "000010110": 10, "000010111": 11, "000011000": 21, "000011001": 4, "000011010": 2, "000011011": 9, "000011100": 4, "000011101": 8, "000011110": 17, "000011111": 2, "000100000": 6, "000100001": 11, "000100010": 14, "000100011": 3, "000100100": 14, "000100101": 5, "000100110": 5, "000100111": 16, "000101000": 23, "000101001": 2, "000101010": 6, "000101011": 10, "000101100": 8, "000101101": 9, "000101110": 12, "000101111": 1, "000110000": 17, "000110001": 1, "000110010": 7, "000110011": 13, "000110100": 3, "000110101": 13, "000110110": 12, "000110111": 5, "000111000": 3, "000111001": 10, "000111010": 14, "000111011": 2, "000111100": 12, "000111101": 3, "000111110": 10, "000111111": 8, "001000000": 6, "001000001": 12, "001000010": 13, "001000011": 9, "001000100": 15, "001000101": 5, "001000110": 6, "001000111": 12, "001001000": 9, "001001001": 4, "001001010": 4, "001001011": 14, "001001100": 1, "001001101": 13, "001001110": 14, "001001111": 2, "001010000": 14, "001010001": 4, "001010010": 5, "001010011": 19, "001010100": 7, "001010101": 12, "001010110": 22, "001010111": 3, "001011000": 2, "001011001": 14, "001011010": 14, "001011011": 3, "001011100": 16, "001011101": 1, "001011110": 5, "001011111": 7, "001100000": 8, "001100001": 8, "001100010": 4, "001100011": 11, "001100100": 6, "001100101": 13, "001100110": 8, "001100111": 3, "001101000": 11, "001101001": 11, "001101010": 12, "001101011": 3, "001101100": 17, "001101101": 3, "001101110": 2, "001101111": 13, "001110000": 6, "001110001": 10, "001110010": 13, "001110011": 3, "001110100": 19, "001110101": 4, "001110110": 5, "001110111": 6, "001111000": 13, "001111001": 3, "001111010": 2, "001111011": 3, "001111100": 4, "001111101": 10, "001111110": 19, "001111111": 4, "010000000": 2, "010000001": 17, "010000010": 16, "010000011": 2, "010000100": 16, "010000101": 3, "010000110": 3, "010000111": 12, "010001000": 11, "010001001": 5, "010001010": 5, "010001011": 10, "010001100": 3, "010001101": 15, "010001110": 17, "010001111": 7, "010010000": 15, "010010001": 3, "010010010": 4, "010010011": 15, "010010100": 5, "010010101": 11, "010010110": 17, "010010111": 2, "010011000": 4, "010011001": 13, "010011010": 10, "010011011": 3, "010011100": 13, "010011101": 2, "010011110": 4, "010011111": 17, "010100000": 13, "010100001": 5, "010100010": 3, "010100011": 13, "010100100": 10, "010100101": 7, "010100110": 18, "010100111": 5, "010101000": 7, "010101001": 11, "010101010": 9, "010101011": 7, "010101100": 11, "010101101": 2, "010101110": 6, "010101111": 14, "010110000": 4, "010110001": 10, "010110010": 20, "010110011": 2, "010110100": 13, "010110101": 2, "010110110": 3, "010110111": 18, "010111000": 18, "010111001": 5, "010111010": 1, "010111011": 15, "010111100": 2, "010111101": 15, "010111110": 7, "010111111": 6, "011000000": 18, "011000001": 4, "011000010": 4, "011000011": 7, "011000100": 4, "011000101": 14, "011000110": 14, "011000111": 3, "011001000": 2, "011001001": 6, "011001010": 14, "011001011": 3, "011001100": 15, "011001101": 1, "011001110": 6, "011001111": 7, "011010000": 8, "011010001": 9, "011010010": 24, "011010011": 3, "011010100": 12, "011010101": 5, "011010110": 5, "011010111": 10, "011011000": 16, "011011001": 4, "011011010": 2, "011011011": 6, "011011100": 2, "011011101": 7, "011011110": 10, "011011111": 4, "011100000": 10, "011100001": 12, "011100010": 15, "011100011": 3, "011100100": 6, "011100101": 1, "011100110": 6, "011100111": 13, "011101000": 14, "011101001": 4, "011101010": 6, "011101011": 12, "011101100": 3, "011101101": 10, "011101110": 11, "011101111": 4, "011110000": 10, "011110010": 7, "011110011": 15, "011110100": 5, "011110101": 11, "011110110": 16, "011110111": 4, "011111000": 2, "011111001": 13, "011111010": 13, "011111011": 1, "011111100": 13, "011111111": 9, "100000000": 5, "100000001": 9, "100000010": 13, "100000011": 3, "100000100": 18, "100000101": 3, "100000110": 4, "100000111": 11, "100001000": 12, "100001001": 4, "100001010": 1, "100001011": 9, "100001100": 5, "100001101": 11, "100001110": 14, "100001111": 1, "100010000": 13, "100010001": 4, "100010010": 8, "100010011": 14, "100010100": 6, "100010101": 14, "100010110": 13, "100010111": 4, "100011000": 3, "100011001": 10, "100011010": 8, "100011011": 2, "100011100": 16, "100011101": 3, "100011110": 7, "100011111": 6, "100100000": 11, "100100001": 1, "100100010": 9, "100100011": 17, "100100100": 9, "100100101": 10, "100100110": 6, "100100111": 4, "100101000": 5, "100101001": 12, "100101010": 13, "100101011": 3, "100101100": 13, "100101101": 2, "100101110": 4, "100101111": 12, "100110000": 3, "100110001": 14, "100110010": 16, "100110011": 3, "100110100": 10, "100110101": 2, "100110110": 4, "100110111": 8, "100111000": 13, "100111010": 4, "100111011": 19, "100111100": 5, "100111101": 9, "100111110": 11, "100111111": 2, "101000000": 23, "101000001": 2, "101000010": 2, "101000011": 16, "101000100": 3, "101000101": 11, "101000110": 12, "101000111": 1, "101001000": 3, "101001001": 10, "101001010": 9, "101001011": 2, "101001100": 11, "101001101": 4, "101001110": 1, "101001111": 16, "101010000": 5, "101010001": 12, "101010010": 16, "101010011": 5, "101010100": 13, "101010101": 3, "101010110": 2, "101010111": 15, "101011000": 7, "101011001": 3, "101011010": 3, "101011011": 8, "101011100": 1, "101011101": 7, "101011110": 9, "101011111": 4, "101100000": 3, "101100001": 9, "101100010": 13, "101100011": 3, "101100100": 9, "101100110": 3, "101100111": 12, "101101000": 9, "101101001": 1, "101101010": 2, "101101011": 17, "101101100": 7, "101101101": 12, "101101110": 16, "101101111": 3, "101110000": 14, "101110001": 1, "101110010": 3, "101110011": 17, "101110100": 2, "101110101": 15, "101110110": 11, "101110111": 4, "101111000": 3, "101111001": 14, "101111010": 13, "101111011": 3, "101111100": 8, "101111101": 1, "101111110": 4, "101111111": 10, "110000000": 10, "110000001": 6, "110000010": 3, "110000011": 8, "110000100": 2, "110000101": 17, "110000110": 14, "110000111": 3, "110001000": 5, "110001001": 11, "110001010": 11, "110001100": 18, "110001101": 1, "110001110": 6, "110001111": 7, "110010000": 4, "110010001": 13, "110010010": 11, "110010011": 3, "110010100": 16, "110010101": 2, "110010110": 9, "110010111": 7, "110011000": 7, "110011001": 2, "110011010": 7, "110011011": 8, "110011100": 1, "110011101": 11, "110011110": 9, "110011111": 3, "110100000": 4, "110100001": 11, "110100010": 8, "110100011": 4, "110100100": 17, "110100101": 1, "110100110": 4, "110100111": 9, "110101000": 8, "110101001": 4, "110101010": 4, "110101011": 9, "110101101": 4, "110101110": 8, "110101111": 2, "110110000": 14, "110110001": 5, "110110010": 5, "110110011": 14, "110110100": 2, "110110101": 14, "110110110": 11, "110110111": 2, "110111000": 1, "110111001": 9, "110111010": 13, "110111011": 2, "110111100": 9, "110111110": 6, "110111111": 12, "111000000": 3, "111000001": 10, "111000010": 8, "111000011": 1, "111000100": 14, "111000101": 5, "111000110": 7, "111000111": 14, "111001000": 8, "111001001": 3, "111001011": 6, "111001100": 4, "111001101": 7, "111001110": 13, "111010000": 15, "111010001": 6, "111010010": 6, "111010011": 11, "111010100": 4, "111010101": 8, "111010110": 12, "111010111": 3, "111011000": 5, "111011001": 9, "111011010": 16, "111011011": 3, "111011100": 12, "111011101": 1, "111011110": 5, "111011111": 15, "111100000": 11, "111100001": 2, "111100010": 4, "111100011": 16, "111100100": 6, "111100101": 12, "111100110": 12, "111100111": 3, "111101000": 2, "111101001": 9, "111101010": 10, "111101011": 2, "111101100": 11, "111101101": 2, "111101111": 8, "111110000": 3, "111110001": 10, "111110010": 14, "111110011": 1, "111110100": 12, "111110101": 2, "111110110": 10, "111110111": 11, "111111000": 18, "111111001": 2, "111111010": 1, "111111011": 19, "111111100": 4, "111111101": 16, "111111110": 14, "111111111": 2}

QAOA = {"000000000": 10, "000000001": 11, "000000010": 4, "000000011": 12, "000000100": 10, "000000101": 6, "000000110": 14, "000000111": 14, "000001000": 9, "000001001": 3, "000001010": 15, "000001011": 10, "000001100": 6, "000001101": 4, "000001110": 12, "000001111": 14, "000010000": 5, "000010001": 6, "000010010": 6, "000010011": 7, "000010100": 5, "000010101": 6, "000010110": 13, "000010111": 9, "000011000": 11, "000011001": 7, "000011010": 7, "000011011": 2, "000011100": 1, "000011101": 3, "000011110": 8, "000011111": 9, "000100000": 11, "000100001": 7, "000100010": 8, "000100011": 7, "000100100": 10, "000100101": 3, "000100110": 11, "000100111": 11, "000101000": 12, "000101001": 16, "000101010": 5, "000101011": 6, "000101100": 8, "000101101": 4, "000101110": 13, "000101111": 14, "000110000": 14, "000110001": 5, "000110010": 8, "000110011": 7, "000110100": 7, "000110101": 7, "000110110": 10, "000110111": 12, "000111000": 10, "000111001": 8, "000111010": 6, "000111011": 4, "000111100": 6, "000111101": 3, "000111110": 15, "000111111": 10, "001000000": 11, "001000001": 5, "001000010": 12, "001000011": 19, "001000100": 7, "001000101": 4, "001000110": 8, "001000111": 7, "001001000": 6, "001001001": 8, "001001010": 12, "001001011": 8, "001001100": 14, "001001101": 6, "001001110": 11, "001001111": 7, "001010000": 12, "001010001": 4, "001010010": 14, "001010011": 7, "001010100": 10, "001010101": 8, "001010110": 8, "001010111": 4, "001011000": 3, "001011001": 7, "001011010": 8, "001011011": 8, "001011100": 6, "001011101": 8, "001011110": 6, "001011111": 10, "001100000": 7, "001100001": 5, "001100010": 8, "001100011": 13, "001100100": 10, "001100101": 11, "001100110": 11, "001100111": 6, "001101000": 2, "001101001": 6, "001101010": 15, "001101011": 7, "001101100": 14, "001101101": 6, "001101110": 8, "001101111": 3, "001110000": 5, "001110001": 5, "001110010": 11, "001110011": 13, "001110100": 13, "001110101": 10, "001110110": 8, "001110111": 7, "001111000": 5, "001111001": 5, "001111010": 15, "001111011": 10, "001111100": 9, "001111101": 9, "001111110": 5, "001111111": 3, "010000000": 7, "010000001": 5, "010000010": 13, "010000011": 10, "010000100": 17, "010000101": 17, "010000110": 7, "010000111": 15, "010001000": 8, "010001001": 4, "010001010": 9, "010001011": 11, "010001100": 5, "010001101": 14, "010001110": 8, "010001111": 5, "010010000": 6, "010010001": 2, "010010010": 9, "010010011": 6, "010010100": 10, "010010101": 10, "010010110": 10, "010010111": 8, "010011000": 8, "010011001": 4, "010011010": 7, "010011011": 8, "010011100": 13, "010011101": 8, "010011110": 5, "010011111": 8, "010100000": 7, "010100001": 4, "010100010": 8, "010100011": 5, "010100100": 9, "010100101": 9, "010100110": 12, "010100111": 7, "010101000": 7, "010101001": 7, "010101010": 9, "010101011": 9, "010101100": 8, "010101101": 14, "010101110": 13, "010101111": 7, "010110000": 2, "010110001": 6, "010110010": 13, "010110011": 13, "010110100": 13, "010110101": 1, "010110110": 9, "010110111": 3, "010111000": 2, "010111001": 2, "010111010": 12, "010111011": 6, "010111100": 13, "010111101": 9, "010111110": 9, "010111111": 2, "011000000": 13, "011000001": 9, "011000010": 11, "011000011": 7, "011000100": 9, "011000101": 3, "011000110": 7, "011000111": 10, "011001000": 7, "011001001": 7, "011001010": 4, "011001011": 1, "011001100": 7, "011001101": 3, "011001110": 5, "011001111": 13, "011010000": 8, "011010001": 12, "011010010": 14, "011010011": 5, "011010100": 6, "011010101": 9, "011010110": 13, "011010111": 18, "011011000": 12, "011011001": 9, "011011010": 7, "011011011": 4, "011011100": 5, "011011101": 5, "011011110": 11, "011011111": 7, "011100000": 12, "011100001": 10, "011100010": 7, "011100011": 7, "011100100": 4, "011100101": 8, "011100110": 15, "011100111": 5, "011101000": 17, "011101001": 3, "011101010": 6, "011101011": 5, "011101100": 8, "011101101": 6, "011101110": 10, "011101111": 9, "011110000": 12, "011110001": 16, "011110010": 11, "011110011": 5, "011110100": 5, "011110101": 4, "011110110": 13, "011110111": 8, "011111000": 2, "011111001": 3, "011111010": 6, "011111011": 6, "011111100": 2, "011111101": 4, "011111110": 11, "011111111": 11, "100000000": 14, "100000001": 5, "100000010": 3, "100000011": 1, "100000100": 7, "100000101": 6, "100000110": 7, "100000111": 13, "100001000": 9, "100001001": 6, "100001010": 8, "100001011": 5, "100001100": 2, "100001101": 3, "100001110": 9, "100001111": 11, "100010000": 15, "100010001": 8, "100010010": 9, "100010011": 5, "100010100": 11, "100010101": 10, "100010110": 11, "100010111": 8, "100011000": 8, "100011001": 16, "100011010": 8, "100011011": 5, "100011100": 7, "100011101": 6, "100011110": 10, "100011111": 5, "100100000": 9, "100100001": 8, "100100010": 6, "100100011": 3, "100100100": 5, "100100101": 7, "100100110": 11, "100100111": 7, "100101000": 16, "100101001": 12, "100101010": 8, "100101011": 8, "100101100": 4, "100101101": 6, "100101110": 12, "100101111": 11, "100110000": 7, "100110001": 11, "100110010": 2, "100110011": 10, "100110100": 5, "100110101": 9, "100110110": 11, "100110111": 10, "100111000": 10, "100111001": 6, "100111010": 6, "100111011": 7, "100111100": 7, "100111101": 6, "100111110": 13, "100111111": 12, "101000000": 7, "101000001": 5, "101000010": 10, "101000011": 7, "101000100": 10, "101000101": 10, "101000110": 10, "101000111": 9, "101001000": 4, "101001001": 3, "101001010": 14, "101001011": 7, "101001100": 5, "101001101": 12, "101001110": 6, "101001111": 8, "101010000": 8, "101010001": 8, "101010010": 6, "101010011": 13, "101010100": 15, "101010101": 8, "101010110": 8, "101010111": 8, "101011000": 5, "101011001": 9, "101011010": 6, "101011011": 8, "101011100": 11, "101011101": 9, "101011110": 6, "101011111": 6, "101100000": 5, "101100001": 7, "101100010": 16, "101100011": 15, "101100100": 10, "101100101": 7, "101100110": 11, "101100111": 6, "101101000": 3, "101101001": 3, "101101010": 12, "101101011": 8, "101101100": 10, "101101101": 5, "101101110": 7, "101101111": 3, "101110000": 5, "101110001": 8, "101110010": 15, "101110011": 10, "101110100": 10, "101110101": 10, "101110110": 10, "101110111": 2, "101111000": 4, "101111001": 5, "101111010": 15, "101111011": 11, "101111100": 6, "101111101": 3, "101111110": 3, "101111111": 5, "110000000": 5, "110000001": 3, "110000010": 9, "110000011": 13, "110000100": 8, "110000101": 10, "110000110": 8, "110000111": 3, "110001000": 7, "110001001": 6, "110001010": 9, "110001011": 12, "110001100": 10, "110001101": 6, "110001110": 11, "110010000": 13, "110010001": 3, "110010010": 9, "110010011": 17, "110010100": 10, "110010101": 12, "110010110": 7, "110010111": 9, "110011000": 4, "110011001": 4, "110011010": 13, "110011011": 6, "110011100": 7, "110011101": 9, "110011110": 5, "110011111": 4, "110100000": 5, "110100001": 5, "110100010": 12, "110100011": 12, "110100100": 12, "110100101": 5, "110100110": 10, "110100111": 6, "110101000": 4, "110101001": 5, "110101010": 12, "110101011": 8, "110101100": 9, "110101101": 2, "110101110": 4, "110101111": 3, "110110000": 5, "110110001": 6, "110110010": 12, "110110011": 6, "110110100": 6, "110110101": 10, "110110110": 3, "110110111": 7, "110111000": 6, "110111001": 4, "110111010": 10, "110111011": 5, "110111100": 9, "110111101": 11, "110111110": 5, "110111111": 5, "111000000": 10, "111000001": 10, "111000010": 12, "111000011": 6, "111000100": 3, "111000101": 2, "111000110": 10, "111000111": 5, "111001000": 7, "111001001": 8, "111001010": 9, "111001011": 5, "111001100": 3, "111001101": 5, "111001110": 14, "111001111": 9, "111010000": 6, "111010001": 8, "111010010": 8, "111010011": 3, "111010100": 5, "111010101": 7, "111010110": 11, "111010111": 10, "111011000": 13, "111011001": 7, "111011010": 4, "111011011": 3, "111011100": 8, "111011101": 7, "111011110": 7, "111011111": 10, "111100000": 11, "111100001": 7, "111100010": 5, "111100011": 7, "111100100": 7, "111100101": 6, "111100110": 14, "111100111": 10, "111101000": 9, "111101001": 11, "111101010": 6, "111101011": 4, "111101100": 3, "111101101": 2, "111101110": 12, "111101111": 11, "111110000": 10, "111110001": 4, "111110010": 6, "111110011": 8, "111110100": 4, "111110101": 2, "111110110": 13, "111110111": 13, "111111000": 9, "111111001": 7, "111111010": 8, "111111011": 5, "111111100": 6, "111111101": 3, "111111110": 17, "111111111": 9}

WALK_D1 = {"000000000": 452, "000000001": 1827, "000000010": 42, "000000011": 103, "000000100": 47, "000000101": 176, "000000110": 3, "000000111": 7, "000001000": 30, "000001001": 133, "000001010": 2, "000001011": 10, "000001100": 6, "000001101": 12, "000001111": 1, "000010000": 30, "000010001": 148, "000010010": 1, "000010011": 12, "000010100": 3, "000010101": 21, "000010111": 1, "000011000": 4, "000011001": 15, "000011010": 1, "000011011": 2, "000011100": 1, "000011101": 2, "000100000": 33, "000100001": 156, "000100010": 2, "000100011": 5, "000100100": 3, "000100101": 16, "000100111": 1, "000101001": 18, "000101101": 1, "000101111": 1, "000110000": 1, "000110001": 16, "000110010": 1, "000110101": 2, "000111001": 2, "001000000": 29, "001000001": 134, "001000010": 3, "001000011": 12, "001000100": 1, "001000101": 15, "001000111": 1, "001001001": 13, "001010000": 2, "001010001": 8, "001100000": 4, "001100001": 14, "001100101": 1, "001101001": 1, "001110001": 1, "001110101": 1, "010000000": 22, "010000001": 132, "010000010": 2, "010000011": 11, "010000100": 4, "010000101": 13, "010000111": 2, "010001000": 3, "010001001": 8, "010001010": 1, "010010000": 1, "010010001": 10, "010010011": 2, "010010100": 1, "010010101": 3, "010011001": 2, "010100000": 2, "010100001": 12, "010100010": 1, "010100100": 1, "010100101": 1, "010101001": 1, "010101011": 1, "011000000": 3, "011000001": 11, "011000100": 1, "011000101": 1, "011001000": 2, "011010001": 2, "011010010": 1, "100000000": 29, "100000001": 111, "100000010": 3, "100000011": 3, "100000100": 4, "100000101": 11, "100000111": 1, "100001000": 1, "100001001": 12, "100001011": 2, "100001101": 1, "100010000": 2, "100010001": 11, "100010100": 1, "100011001": 1, "100011011": 1, "100100000": 1, "100100001": 7, "100100100": 1, "100100101": 1, "100101001": 1, "100110110": 1, "100111001": 1, "101000000": 2, "101000001": 8, "101000010": 1, "101000011": 2, "101010001": 2, "101100001": 1, "101100101": 1, "110000000": 4, "110000001": 9, "110000011": 2, "110000100": 1, "110000101": 1, "110001000": 1, "110001100": 1, "110100000": 1, "110110001": 1, "111000001": 3, "111000011": 1}

WALK_D2 = {"000000000": 209, "000000001": 500, "000000010": 15, "000000011": 19, "000000100": 22, "000000101": 22, "000000110": 5, "000000111": 3, "000001000": 61, "000001001": 128, "000001010": 4, "000001011": 10, "000001100": 9, "000001101": 8, "000001110": 3, "000010000": 86, "000010001": 155, "000010010": 10, "000010011": 12, "000010100": 6, "000010101": 16, "000010110": 2, "000010111": 2, "000011000": 33, "000011001": 48, "000011010": 1, "000011011": 3, "000011100": 1, "000011101": 7, "000100000": 74, "000100001": 160, "000100010": 6, "000100011": 6, "000100100": 11, "000100101": 12, "000100111": 1, "000101000": 25, "000101001": 32, "000101010": 3, "000101011": 1, "000101100": 5, "000101101": 4, "000110000": 22, "000110001": 52, "000110010": 2, "000110011": 1, "000110100": 1, "000110101": 9, "000110110": 1, "000110111": 1, "000111000": 11, "000111001": 12, "000111011": 1, "000111100": 2, "000111101": 1, "001000000": 121, "001000001": 238, "001000010": 3, "001000011": 1, "001000100": 13, "001000101": 10, "001000110": 1, "001001000": 5, "001001001": 12, "001010000": 9, "001010001": 19, "001010011": 1, "001010100": 2, "001010101": 1, "001011000": 5, "001011001": 8, "001100000": 33, "001100001": 82, "001100010": 5, "001100100": 6, "001100101": 11, "001101000": 3, "001101001": 5, "001110000": 4, "001110001": 6, "001110011": 2, "001110101": 1, "010000000": 127, "010000001": 218, "010000010": 6, "010000011": 11, "010000100": 7, "010000101": 3, "010000110": 6, "010001000": 37, "010001001": 83, "010001010": 3, "010001011": 3, "010001100": 3, "010001101": 1, "010010000": 8, "010010001": 23, "010010010": 2, "010010100": 2, "010010101": 2, "010010111": 1, "010011000": 2, "010011001": 3, "010011010": 1, "010011011": 2, "010011100": 1, "010100000": 13, "010100001": 16, "010100010": 1, "010100011": 1, "010100100": 2, "010101001": 5, "010101101": 2, "010110000": 3, "010110001": 8, "010110101": 1, "010111010": 1, "011000000": 56, "011000001": 85, "011000010": 2, "011000100": 3, "011000101": 1, "011001000": 3, "011001001": 9, "011001101": 1, "011010000": 6, "011010001": 7, "011011001": 2, "011100000": 2, "011100001": 5, "011110000": 1, "011110001": 1, "011111001": 1, "100000000": 107, "100000001": 210, "100000010": 8, "100000011": 13, "100000100": 10, "100000101": 6, "100000110": 4, "100001000": 24, "100001001": 46, "100001011": 2, "100001100": 5, "100001101": 4, "100010000": 29, "100010001": 45, "100010010": 2, "100010011": 4, "100010100": 3, "100010101": 3, "100010111": 1, "100011000": 8, "100011001": 18, "100011011": 1, "100011101": 2, "100100000": 38, "100100001": 47, "100100010": 3, "100100011": 5, "100100100": 9, "100100101": 3, "100101000": 10, "100101001": 17, "100101011": 2, "100101101": 3, "100110000": 3, "100110001": 16, "100110010": 1, "100110011": 2, "100110100": 1, "100110101": 1, "100111000": 6, "100111001": 4, "100111010": 1, "100111011": 2, "100111101": 1, "101000000": 5, "101000001": 17, "101000101": 1, "101000110": 1, "101001000": 1, "101001001": 3, "101010000": 1, "101010001": 6, "101010110": 1, "101011000": 1, "101011001": 2, "101100000": 1, "101100001": 3, "101100010": 1, "101110000": 1, "101110001": 2, "110000000": 9, "110000001": 13, "110000010": 1, "110000100": 2, "110000101": 1, "110000111": 1, "110001000": 1, "110001001": 1, "110010000": 3, "110010001": 2, "110010101": 1, "110011000": 2, "110011001": 2, "110100000": 3, "110100001": 4, "110100011": 2, "110110000": 1, "110110001": 1, "111000000": 2, "111000001": 7, "111000010": 1, "111000100": 1, "111010010": 1, "111100001": 1}

WALK_D3 = {"000000000": 41, "000000001": 29, "000000010": 13, "000000011": 9, "000000100": 20, "000000101": 9, "000000110": 7, "000000111": 5, "000001000": 30, "000001001": 26, "000001010": 2, "000001011": 12, "000001100": 13, "000001101": 6, "000001111": 6, "000010000": 67, "000010001": 59, "000010010": 11, "000010011": 12, "000010100": 10, "000010101": 22, "000010110": 2, "000010111": 8, "000011000": 41, "000011001": 43, "000011010": 4, "000011100": 6, "000011101": 14, "000011110": 1, "000100000": 40, "000100001": 42, "000100010": 21, "000100011": 11, "000100100": 2, "000100101": 20, "000100110": 1, "000100111": 2, "000101000": 43, "000101001": 30, "000101010": 4, "000101011": 14, "000101100": 8, "000101101": 16, "000110000": 73, "000110001": 47, "000110010": 4, "000110011": 18, "000110100": 6, "000110101": 4, "000110110": 1, "000110111": 1, "000111000": 32, "000111001": 32, "000111010": 6, "000111100": 3, "000111101": 2, "000111110": 2, "000111111": 1, "001000000": 94, "001000001": 93, "001000010": 19, "001000011": 12, "001000100": 25, "001000101": 7, "001000110": 8, "001000111": 1, "001001000": 5, "001001001": 7, "001001100": 2, "001001101": 1, "001001110": 3, "001001111": 1, "001010000": 3, "001010001": 6, "001010010": 1, "001010011": 4, "001010100": 4, "001010101": 1, "001010110": 1, "001010111": 1, "001011000": 6, "001011001": 6, "001011010": 2, "001011100": 2, "001011101": 4, "001100000": 118, "001100001": 124, "001100010": 24, "001100011": 11, "001100100": 19, "001100101": 44, "001100110": 1, "001100111": 3, "001101000": 7, "001101001": 6, "001101010": 1, "001101011": 4, "001101111": 1, "001110000": 10, "001110001": 6, "001110010": 1, "001110011": 2, "001110101": 4, "001110111": 1, "001111000": 5, "001111001": 5, "001111010": 3, "001111101": 1, "010000000": 124, "010000001": 125, "010000010": 21, "010000011": 12, "010000100": 16, "010000101": 13, "010000110": 9, "010001000": 105, "010001001": 79, "010001010": 10, "010001011": 26, "010001100": 30, "010001101": 3, "010001110": 2, "010001111": 2, "010010000": 9, "010010001": 7, "010010010": 1, "010010011": 2, "010010110": 2, "010011000": 4, "010011001": 3, "010011011": 1, "010011101": 1, "010100000": 6, "010100001": 7, "010100011": 1, "010100100": 1, "010100101": 2, "010101000": 6, "010101001": 3, "010101011": 1, "010101101": 1, "010110000": 8, "010110001": 7, "010110010": 2, "010110011": 3, "010110100": 1, "010110101": 1, "010111000": 6, "010111001": 1, "010111011": 1, "010111100": 1, "011000000": 122, "011000001": 118, "011000010": 15, "011000011": 14, "011000100": 28, "011000101": 9, "011000110": 13, "011001000": 11, "011001001": 8, "011001010": 1, "011001100": 2, "011001110": 1, "011010000": 20, "011010001": 11, "011010010": 3, "011010100": 2, "011010101": 3, "011010110": 1, "011011000": 1, "011011001": 1, "011011100": 1, "011100000": 10, "011100001": 7, "011100010": 5, "011100011": 2, "011100100": 6, "011100101": 3, "011100110": 1, "011101000": 1, "011110000": 1, "011110001": 1, "011111000": 1, "011111001": 1, "100000000": 71, "100000001": 86, "100000010": 22, "100000011": 15, "100000100": 23, "100000101": 18, "100000110": 7, "100000111": 1, "100001000": 37, "100001001": 41, "100001010": 5, "100001011": 16, "100001100": 13, "100001101": 5, "100001111": 2, "100010000": 66, "100010001": 39, "100010010": 10, "100010011": 8, "100010100": 10, "100010101": 10, "100010110": 2, "100010111": 11, "100011000": 36, "100011001": 16, "100011010": 4, "100011011": 1, "100011100": 2, "100011101": 14, "100011111": 1, "100100000": 59, "100100001": 41, "100100010": 13, "100100011": 7, "100100100": 16, "100100101": 14, "100100110": 1, "100101000": 37, "100101001": 28, "100101010": 5, "100101011": 10, "100101100": 7, "100101101": 9, "100101111": 5, "100110000": 49, "100110001": 42, "100110010": 8, "100110011": 11, "100110100": 4, "100110101": 2, "100110110": 1, "100111000": 27, "100111001": 19, "100111010": 4, "100111011": 3, "100111100": 2, "100111101": 1, "101000000": 6, "101000001": 5, "101000010": 1, "101000100": 2, "101000101": 1, "101001000": 5, "101001001": 7, "101001010": 1, "101001011": 3, "101001100": 3, "101001110": 1, "101010000": 5, "101010010": 1, "101010011": 1, "101010100": 2, "101010101": 3, "101011000": 3, "101011001": 2, "101011101": 1, "101100000": 8, "101100001": 5, "101100010": 1, "101100100": 3, "101100101": 3, "101101000": 4, "101101001": 2, "101101010": 2, "101101011": 2, "101101100": 1, "101101111": 1, "101110000": 7, "101110001": 2, "101110011": 2, "101111011": 1, "110000000": 4, "110000001": 3, "110000010": 1, "110000011": 1, "110000100": 3, "110000111": 1, "110001000": 4, "110001001": 3, "110001011": 1, "110001100": 2, "110001101": 1, "110010000": 4, "110010001": 4, "110010010": 1, "110010011": 1, "110010100": 2, "110010101": 3, "110011000": 4, "110011001": 2, "110011010": 1, "110011100": 1, "110011101": 3, "110100000": 8, "110100001": 5, "110100010": 2, "110100100": 2, "110100101": 2, "110100110": 1, "110101000": 1, "110101001": 3, "110101011": 2, "110101100": 2, "110101111": 1, "110110000": 3, "110110001": 2, "110111000": 3, "110111001": 4, "110111010": 1, "111000000": 15, "111000001": 15, "111000100": 4, "111000101": 2, "111000110": 2, "111001001": 1, "111001010": 1, "111010000": 6, "111010001": 11, "111010100": 2, "111010110": 1, "111100000": 2, "111101000": 2, "111110101": 1, "111111000": 1}


def bitstring_parity(bs):
    """Count number of 1s in bitstring, return even (0) or odd (1)."""
    return bs.count("1") % 2


def cut_value(bitstring):
    """Compute MaxCut value for a bitstring. QI convention: rightmost = q[0]."""
    bits = bitstring[::-1]  # reverse so bits[i] = q[i]
    cuts = 0
    for i, j in EDGES:
        if bits[i] != bits[j]:
            cuts += 1
    return cuts


def qubit_excitation(results, qubit):
    """Compute P(q[qubit] = 1) from results. QI convention: rightmost = q[0]."""
    total = sum(results.values())
    excited = 0
    for bs, count in results.items():
        # rightmost bit = q[0], so q[i] = bs[-(i+1)]
        if bs[-(qubit + 1)] == "1":
            excited += count
    return excited / total


# ═══════════════════════════════════════════════════════════════════════════════
#  1. GHZ ANALYSIS
# ═══════════════════════════════════════════════════════════════════════════════

def analyze_ghz():
    total_z = sum(GHZ_Z.values())
    total_x = sum(GHZ_X.values())

    # F_z = P(|000...0⟩) + P(|111...1⟩)
    p_all0 = GHZ_Z.get("000000000", 0) / total_z
    p_all1 = GHZ_Z.get("111111111", 0) / total_z
    f_z = p_all0 + p_all1

    # X-basis: ⟨X^⊗9⟩ = (even_parity - odd_parity) / total
    even_counts = sum(c for bs, c in GHZ_X.items() if bitstring_parity(bs) == 0)
    odd_counts = sum(c for bs, c in GHZ_X.items() if bitstring_parity(bs) == 1)
    x_expectation = (even_counts - odd_counts) / total_x

    # Fidelity lower bound: F ≥ 0.5 * (F_z + |⟨X^⊗9⟩|)
    fidelity_bound = 0.5 * (f_z + abs(x_expectation))

    print("=" * 70)
    print("  9-QUBIT GHZ STATE — TUNA-9 HARDWARE")
    print("=" * 70)
    print()
    print(f"  Z-basis measurement ({total_z} shots):")
    print(f"    |000000000⟩: {GHZ_Z.get('000000000', 0):>5} ({p_all0:.1%})")
    print(f"    |111111111⟩: {GHZ_Z.get('111111111', 0):>5} ({p_all1:.1%})")
    print(f"    F_z = {f_z:.4f}")
    print()

    # Show top error states
    print("  Top error states (Z-basis):")
    z_sorted = sorted(GHZ_Z.items(), key=lambda x: -x[1])
    for bs, count in z_sorted[2:8]:
        p = count / total_z
        # Figure out which qubit flipped
        dist_from_0 = sum(1 for b in bs if b == "1")
        dist_from_1 = sum(1 for b in bs if b == "0")
        if dist_from_0 <= 2:
            note = f"  ({dist_from_0} flip{'s' if dist_from_0 > 1 else ''} from |0...0⟩)"
        elif dist_from_1 <= 2:
            note = f"  ({dist_from_1} flip{'s' if dist_from_1 > 1 else ''} from |1...1⟩)"
        else:
            note = ""
        print(f"    |{bs}⟩: {count:>5} ({p:.1%}){note}")
    print()

    print(f"  X-basis measurement ({total_x} shots):")
    print(f"    Even parity: {even_counts:>5} ({even_counts/total_x:.1%})")
    print(f"    Odd parity:  {odd_counts:>5} ({odd_counts/total_x:.1%})")
    print(f"    ⟨X^⊗9⟩ = {x_expectation:.4f}")
    print()

    print(f"  ┌─────────────────────────────────────────┐")
    print(f"  │  GHZ fidelity ≥ {fidelity_bound:.4f}                 │")
    print(f"  │  F_z = {f_z:.4f}  |  ⟨X^⊗9⟩ = {x_expectation:.4f}   │")
    print(f"  └─────────────────────────────────────────┘")
    print()

    # Per-qubit readout error analysis from Z-basis
    print("  Per-qubit readout bias (from Z-basis errors):")
    # For |0...0⟩ errors: which qubits flip to 1
    # For |1...1⟩ errors: which qubits flip to 0
    flip_01 = [0] * N_QUBITS  # 0→1 flips
    flip_10 = [0] * N_QUBITS  # 1→0 flips
    for bs, count in GHZ_Z.items():
        bits = bs[::-1]  # q[i] = bits[i]
        if sum(1 for b in bits if b == "1") <= 3:
            # likely came from |0...0⟩
            for i in range(N_QUBITS):
                if bits[i] == "1":
                    flip_01[i] += count
        elif sum(1 for b in bits if b == "0") <= 3:
            # likely came from |1...1⟩
            for i in range(N_QUBITS):
                if bits[i] == "0":
                    flip_10[i] += count
    print("    Qubit:  ", "  ".join(f"q{i}" for i in range(N_QUBITS)))
    print("    0→1:    ", "  ".join(f"{c:3d}" for c in flip_01))
    print("    1→0:    ", "  ".join(f"{c:3d}" for c in flip_10))
    print()

    return {"f_z": f_z, "x_exp": x_expectation, "fidelity_bound": fidelity_bound}


# ═══════════════════════════════════════════════════════════════════════════════
#  2. QAOA MAXCUT ANALYSIS
# ═══════════════════════════════════════════════════════════════════════════════

def analyze_qaoa():
    total = sum(QAOA.values())

    # Compute expected cut value
    total_cut = 0
    cut_dist = {}  # cut_value → total counts
    for bs, count in QAOA.items():
        cv = cut_value(bs)
        total_cut += cv * count
        cut_dist[cv] = cut_dist.get(cv, 0) + count

    expected_cut = total_cut / total
    approx_ratio = expected_cut / MAX_CUT

    # Probability of optimal bitstrings
    p_optimal = sum(QAOA.get(bs, 0) for bs in OPTIMAL_BITSTRINGS) / total

    # Random baseline: expected cut for random bitstring
    random_cut = sum(1 for _ in EDGES) / 2  # each edge cut with prob 0.5
    random_ratio = random_cut / MAX_CUT

    print("=" * 70)
    print("  QAOA MaxCut (p=1) — TUNA-9's OWN TOPOLOGY")
    print("=" * 70)
    print(f"  Parameters: γ = π/2, β = π/4")
    print(f"  Graph: 9 qubits, 12 edges (bipartite → MaxCut = {MAX_CUT})")
    print(f"  Shots: {total}")
    print()

    print(f"  Approximation ratio: {approx_ratio:.4f}")
    print(f"  Expected cut value:  {expected_cut:.2f} / {MAX_CUT}")
    print(f"  Random baseline:     {random_ratio:.4f} ({random_cut:.1f} / {MAX_CUT})")
    print(f"  Emulator result:     0.6910 (for comparison)")
    print()

    # Optimal solution probability
    for bs in sorted(OPTIMAL_BITSTRINGS):
        c = QAOA.get(bs, 0)
        print(f"  |{bs}⟩ (cut={MAX_CUT}): {c:>4} shots ({c/total:.2%})")
    print(f"  P(optimal) = {p_optimal:.4f} (emulator: 0.1110)")
    print()

    # Cut value distribution
    print("  Cut value distribution:")
    for cv in sorted(cut_dist.keys()):
        c = cut_dist[cv]
        bar = "█" * int(c / total * 100)
        print(f"    {cv:>2}: {c:>5} ({c/total:5.1%}) {bar}")
    print()

    # Top 10 most frequent bitstrings
    print("  Top 10 most frequent bitstrings:")
    top = sorted(QAOA.items(), key=lambda x: -x[1])[:10]
    for bs, count in top:
        cv = cut_value(bs)
        opt = " ★" if bs in OPTIMAL_BITSTRINGS else ""
        print(f"    |{bs}⟩  cut={cv:>2}  {count:>4} ({count/total:.2%}){opt}")
    print()

    print(f"  ┌─────────────────────────────────────────┐")
    print(f"  │  QAOA approx ratio: {approx_ratio:.4f}              │")
    print(f"  │  vs random: {random_ratio:.4f} (+{approx_ratio-random_ratio:.4f})       │")
    print(f"  │  P(optimal) = {p_optimal:.4f}                    │")
    print(f"  └─────────────────────────────────────────┘")
    print()

    return {"approx_ratio": approx_ratio, "expected_cut": expected_cut, "p_optimal": p_optimal}


# ═══════════════════════════════════════════════════════════════════════════════
#  3. QUANTUM WALK ANALYSIS
# ═══════════════════════════════════════════════════════════════════════════════

def analyze_walk():
    walks = {"depth=1": WALK_D1, "depth=2": WALK_D2, "depth=3": WALK_D3}

    # Tuna-9 graph distances from q0
    distances = {0: 0, 1: 1, 2: 1, 3: 2, 4: 2, 5: 2, 6: 3, 7: 3, 8: 4}
    dist_labels = {0: "q0 (start)", 1: "q1,q2 (d=1)", 2: "q3,q4,q5 (d=2)",
                   3: "q6,q7 (d=3)", 4: "q8 (d=4)"}

    print("=" * 70)
    print("  QUANTUM WALK — INFORMATION SPREADING ON TUNA-9")
    print("=" * 70)
    print(f"  Starting qubit: q[0]")
    print(f"  Walk: Ry(π/6) all qubits + CZ on all edges per step")
    print()

    all_excitations = {}

    for label, results in walks.items():
        total = sum(results.values())
        print(f"  {label} ({total} shots):")

        # Per-qubit excitation
        excitations = []
        for q in range(N_QUBITS):
            p = qubit_excitation(results, q)
            excitations.append(p)
        all_excitations[label] = excitations

        # Print per-qubit
        print("    Per-qubit excitation P(q[i]=1):")
        for q in range(N_QUBITS):
            bar = "█" * int(excitations[q] * 60)
            d = distances[q]
            print(f"      q[{q}] (d={d}): {excitations[q]:.3f} {bar}")

        # Print by distance
        print("    By graph distance from q[0]:")
        for d in sorted(set(distances.values())):
            qubits = [q for q, dd in distances.items() if dd == d]
            avg = sum(excitations[q] for q in qubits) / len(qubits)
            print(f"      d={d} ({', '.join(f'q{q}' for q in qubits)}): avg={avg:.3f}")

        # Total excitation (should be ~1 if no multi-excitation)
        total_exc = sum(excitations)
        print(f"    Total excitation: {total_exc:.3f} (1.0 = single particle conserved)")

        # P(vacuum) = P(000000000)
        p_vacuum = results.get("000000000", 0) / total
        print(f"    P(vacuum |0...0⟩): {p_vacuum:.3f}")

        print()

    # Summary table
    print("  ┌──────────┬────────┬────────┬────────┐")
    print("  │  Qubit   │ depth1 │ depth2 │ depth3 │")
    print("  ├──────────┼────────┼────────┼────────┤")
    for q in range(N_QUBITS):
        d = distances[q]
        vals = [f"{all_excitations[f'depth={i}'][q]:.3f}" for i in [1, 2, 3]]
        print(f"  │ q[{q}] d={d}  │ {vals[0]} │ {vals[1]} │ {vals[2]} │")
    print("  └──────────┴────────┴────────┴────────┘")
    print()

    # Key observation: quantum interference
    print("  Key observation — quantum walk interference:")
    for label, exc in all_excitations.items():
        d1_avg = (exc[1] + exc[2]) / 2  # distance 1
        d2_avg = (exc[3] + exc[4] + exc[5]) / 3  # distance 2
        d3_avg = (exc[6] + exc[7]) / 2  # distance 3
        print(f"    {label}: d=0: {exc[0]:.3f}  d=1: {d1_avg:.3f}  d=2: {d2_avg:.3f}  d=3: {d3_avg:.3f}  d=4: {exc[8]:.3f}")

    print()
    return all_excitations


# ═══════════════════════════════════════════════════════════════════════════════
#  MAIN
# ═══════════════════════════════════════════════════════════════════════════════

if __name__ == "__main__":
    ghz = analyze_ghz()
    qaoa = analyze_qaoa()
    walk = analyze_walk()

    # Overall summary
    print("=" * 70)
    print("  TUNA-9 TRIO — SUMMARY")
    print("=" * 70)
    print(f"  GHZ:  F ≥ {ghz['fidelity_bound']:.3f}  (F_z={ghz['f_z']:.3f}, ⟨X⊗9⟩={ghz['x_exp']:.3f})")
    print(f"  QAOA: approx ratio = {qaoa['approx_ratio']:.3f}  (random = 0.500)")
    print(f"        P(optimal MaxCut=12) = {qaoa['p_optimal']:.4f}")
    print(f"  Walk: excitation spreading d=0→d=4 across {len(EDGES)} edges")
    print()
